id: audit_candidate
namespace: ai.gitverified

inputs:
  - name: candidate_name
    type: STRING
  - name: github_url
    type: STRING

tasks:
  - id: parallel_forensics
    type: io.kestra.core.tasks.flows.Parallel
    tasks:
      - id: algo_check
        type: io.kestra.plugin.scripts.python.Script
        script: |
          from agents.agent_algo import AlgoAgent
          agent = AlgoAgent()
          # Call agent logic
          print(f"Checking algo for {inputs.github_url}")

      - id: oumi_check
        type: io.kestra.plugin.scripts.python.Script
        script: |
          from agents.agent_oumi import OumiAgent
          agent = OumiAgent()
          # Call agent logic
          print(f"Checking uniqueness for {inputs.github_url}")

      - id: rabbit_check
        type: io.kestra.plugin.scripts.python.Script
        script: |
          from agents.agent_rabbit import CodeRabbitAgent
          agent = CodeRabbitAgent()
          # Call agent logic
          print(f"Audit quality for {inputs.github_url}")

  - id: generate_verdict
    type: io.kestra.plugin.ai.LLMSummarize
    prompt: "Based on the outputs above, is this candidate a 'Grinder', 'Cheater', or 'Prodigy'?"

  - id: notify_ats
    type: io.kestra.core.tasks.log.Log
    message: "Candidate {{ inputs.candidate_name }} Audit Complete."
